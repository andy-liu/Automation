package com.zerozero.AndroidAppAutoTestCases;

import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.Reader;
import java.io.Writer;
import java.util.ArrayList;
import java.util.List;

import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVPrinter;
import org.apache.commons.csv.CSVRecord;
import org.junit.Test;


public class TryFileIO {

	@Test
	public void readCSV() throws IOException {
		Reader in = null;
		CSVParser parser = null;
		try {
			in = new FileReader("D:\\workspace\\AndroidAppAuto\\data\\testCSV.csv");
			parser = new CSVParser(in, CSVFormat.EXCEL.withHeader());
			for (CSVRecord record : parser){
				System.out.println("username: "+record.get("username"));
				System.out.println("password: "+ record.get("password"));
			}
		} catch (Exception e) {
			// TODO: handle exception
			e.printStackTrace();
		}finally {
			parser.close();
			in.close();
		}
		
	}

	@Test
	public void writeCSV() throws IOException{

		List<String> user = new ArrayList<String>();
		user.add(0, "zhenyu");
		user.add(1, "123456");
//		System.out.println(user);
		Writer out = new FileWriter("D:\\workspace\\AndroidAppAuto\\data\\testCSV.csv");
		CSVPrinter printer = new CSVPrinter(out, CSVFormat.EXCEL.withHeader());
		printer.printRecord(user);
		printer.close();
		out.close();
	}
}
